<%- include('../partials/header.ejs') %> 
<%- include('../partials/nav.ejs') %> 
<h4 class="thread-show-title"><%= thread.title %></h4>
<div class="new-comment">
  <form class="comment-form" action="/threads/<%= thread._id %>/comments" method="POST">
    <textarea name="text" placeholder="add comment" rows="8"></textarea>
    <button type="submit">post comment</button>
  </form>
</div>
<h5 class="thread-show-title">Comments</h5>
<div class="comment-list">
  <% thread.comments.forEach(comment => { %>
    <div class="comment">
      <div class="profile">
        </a><img src="<%= comment.userAvatar %>"alt="avatar"><%= comment.userName %>
      </div>
      <!-- <form action="" method="POST">
        <label for="text"></label>
        <textarea id="hidden-edit" name="text" readonly rows="8"><%= comment.text %></textarea>
        <button id="edit-button" type="submit">update comment</button>
      </form> -->
      <p><%= comment.text %></p>
      <div class="comment-options">
        <% if (user && user._id.equals(comment.user)) { %>
          <form action="/comments/<%= comment._id %>?_method=DELETE" method="POST">
            <input type="image" src="/images/trash-can-solid.svg" alt="delete">
          </form>
        <% } %>
        <input type="image" src="/images/edit-pen.svg" name="edit" alt="edit comment" onclick="toggleEdit()">
        <!-- <button onclick="toggleEdit()">edit</button> -->
        <a href=""><img src="/images/thumbs-up-solid.svg" alt="like"></a>
      </div>
    </div>
  <% }) %>
</div>
<script>
  const inputEl = document.getElementById('hidden-edit');
  const submitBtn = document.getElementById('edit-button');
  let editing = false;
  function toggleEdit() {
    editing = !editing;
    inputEl.readOnly = !editing;
    submitBtn.style.visibiliy = editing ? 'visible' : 'hidden'
  };
</script>
<%- include('../partials/footer.ejs') %> 
